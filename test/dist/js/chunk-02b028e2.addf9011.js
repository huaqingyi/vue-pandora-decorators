(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02b028e2"],{"20b1":function(e,t,r){},"3c6a":function(e,t,r){"use strict";r.r(t);r("a4d3"),r("e01a"),r("b0c0");var n=r("7a23"),a=Object(n["withScopeId"])("data-v-e24958ee");Object(n["pushScopeId"])("data-v-e24958ee");var o={class:"root"},c={class:"sttitle"},u={class:"btns"},i={class:"btn"},s={class:"btn"},l=Object(n["createTextVNode"])("添加"),f=Object(n["createTextVNode"])("保存"),b=Object(n["createTextVNode"])("取消"),d={key:1,class:"flex-btns"},v={class:"btn"},p=Object(n["createTextVNode"])("编辑"),m={class:"btn"},h=Object(n["createTextVNode"])("删除");Object(n["popScopeId"])();var O=a((function(e,t,r,O,g,j){var k=Object(n["resolveComponent"])("SearchOutlined"),w=Object(n["resolveComponent"])("a-button"),x=Object(n["resolveComponent"])("vxe-table-column"),C=Object(n["resolveComponent"])("vxe-button"),N=Object(n["resolveComponent"])("a-popconfirm"),V=Object(n["resolveComponent"])("vxe-table"),y=Object(n["resolveComponent"])("a-card"),R=Object(n["resolveComponent"])("a-input"),D=Object(n["resolveComponent"])("a-form-item"),_=Object(n["resolveComponent"])("a-textarea"),S=Object(n["resolveComponent"])("a-form"),P=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createBlock"])("section",o,[Object(n["createVNode"])(y,null,{title:a((function(){return[Object(n["createVNode"])("div",c,[Object(n["createVNode"])("div",u,[Object(n["createVNode"])("div",i,[Object(n["createVNode"])(w,{onClick:e.reloadData,type:"primary",shape:"circle"},{icon:a((function(){return[Object(n["createVNode"])(k)]})),_:1},8,["onClick"])]),Object(n["createVNode"])("div",s,[Object(n["createVNode"])(w,{onClick:t[1]||(t[1]=function(t){return e.visible=!0}),type:"primary"},{default:a((function(){return[l]})),_:1})])])])]})),default:a((function(){return[Object(n["createVNode"])(V,{ref:e.$setRef((function(e){return e.xTable})),border:"","show-overflow":"","keep-source":"",data:e.tableData.clusterList,"edit-config":{trigger:"manual",mode:"row",autoClear:!1,tableRules:e.tableRules}},{default:a((function(){return[Object(n["createVNode"])(x,{field:"name",title:"名称"}),Object(n["createVNode"])(x,{field:"region",title:"地区","edit-render":{name:"editorInput"}}),Object(n["createVNode"])(x,{field:"kubeconfig",title:"Kubernetes 配置"},{default:a((function(t){var r=t.row;return[Object(n["createVNode"])("a",{onClick:function(t){return e.configShow(r)},href:"#"},"查看配置",8,["onClick"])]})),_:1}),Object(n["createVNode"])(x,{field:"volumes",title:"磁盘信息"},{default:a((function(t){var r=t.row;return[Object(n["createVNode"])("a",{onClick:function(t){return e.volumesShow(r)},href:"#"},"查看磁盘信息",8,["onClick"])]})),_:1}),Object(n["createVNode"])(x,{title:"操作"},{default:a((function(t){var r=t.row;return[e.xTable.isActiveByRow(r)?(Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],{key:0},[Object(n["createVNode"])(C,{onClick:function(t){return e.editSubmit(r)}},{default:a((function(){return[f]})),_:2},1032,["onClick"]),Object(n["createVNode"])(C,{onClick:function(){return e.xTable.clearActived().then((function(){return e.xTable.revertData(r)}))}},{default:a((function(){return[b]})),_:2},1032,["onClick"])],64)):(Object(n["openBlock"])(),Object(n["createBlock"])("div",d,[Object(n["createVNode"])("div",v,[Object(n["createVNode"])(C,{onClick:function(t){return e.xTable.setActiveRow(r)}},{default:a((function(){return[p]})),_:2},1032,["onClick"])]),Object(n["createVNode"])("div",m,[Object(n["createVNode"])(N,{title:"是否删除这条配置?",onConfirm:function(t){return e.deleteRow(r)}},{default:a((function(){return[Object(n["createVNode"])(w,null,{default:a((function(){return[h]})),_:1})]})),_:2},1032,["onConfirm"])])]))]})),_:1})]})),_:1},8,["data","edit-config"])]})),_:1}),Object(n["createVNode"])(P,{width:"65%",title:"添加配置",visible:e.visible,"onUpdate:visible":t[7]||(t[7]=function(t){return e.visible=t}),"confirm-loading":e.loading,onOk:e.handleOk},{default:a((function(){return[Object(n["createVNode"])(S,{ref:e.$setRef((function(e){return e.form})),model:e.formData,rules:e.rules,layout:"vertical"},{default:a((function(){return[Object(n["createVNode"])(D,{ref:"name",label:"名称",name:"name"},{default:a((function(){return[Object(n["createVNode"])(R,{value:e.formData.name,"onUpdate:value":t[2]||(t[2]=function(t){return e.formData.name=t})},null,8,["value"])]})),_:1},512),Object(n["createVNode"])(D,{label:"地区",name:"region"},{default:a((function(){return[Object(n["createVNode"])(R,{value:e.formData.region,"onUpdate:value":t[3]||(t[3]=function(t){return e.formData.region=t})},null,8,["value"])]})),_:1}),Object(n["createVNode"])(D,{label:"备注信息",name:"description"},{default:a((function(){return[Object(n["createVNode"])(R,{value:e.formData.description,"onUpdate:value":t[4]||(t[4]=function(t){return e.formData.description=t})},null,8,["value"])]})),_:1}),Object(n["createVNode"])(D,{label:"Kubernetes 配置",name:"kubeconfig"},{default:a((function(){return[Object(n["createVNode"])(_,{value:e.formData.kubeconfig,"onUpdate:value":t[5]||(t[5]=function(t){return e.formData.kubeconfig=t}),rows:10},null,8,["value"])]})),_:1}),Object(n["createVNode"])(D,{label:"磁盘信息",name:"volumes"},{default:a((function(){return[Object(n["createVNode"])(_,{value:e.formData.volumes,"onUpdate:value":t[6]||(t[6]=function(t){return e.formData.volumes=t}),rows:10},null,8,["value"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["visible","confirm-loading","onOk"]),Object(n["createVNode"])(P,{width:"65%",title:"Kubernetes 配置",visible:e.configVisible,"onUpdate:visible":t[9]||(t[9]=function(t){return e.configVisible=t}),"confirm-loading":e.configLoading,onOk:e.configHandleOk},{default:a((function(){return[Object(n["createVNode"])(_,{value:e.config,"onUpdate:value":t[8]||(t[8]=function(t){return e.config=t}),rows:20},null,8,["value"])]})),_:1},8,["visible","confirm-loading","onOk"]),Object(n["createVNode"])(P,{width:"65%",title:"磁盘信息",visible:e.volumesVisible,"onUpdate:visible":t[11]||(t[11]=function(t){return e.volumesVisible=t}),"confirm-loading":e.volumesLoading,onOk:e.volumesHandleOk},{default:a((function(){return[Object(n["createVNode"])(_,{value:e.volumes,"onUpdate:value":t[10]||(t[10]=function(t){return e.volumes=t}),rows:20},null,8,["value"])]})),_:1},8,["visible","confirm-loading","onOk"])])})),g=(r("d3b7"),r("5530")),j=(r("96cf"),r("1da1")),k=r("d4ec"),w=r("bee2"),x=r("262e"),C=r("2caf"),N=r("9ab4"),V=r("964b"),y=r("0613"),R=r("eab1"),D=function(e){Object(x["a"])(r,e);var t=Object(C["a"])(r);function r(){var e;return Object(k["a"])(this,r),e=t.call(this),e.clusterList=[],e}return r}(R["a"]),_=function(e){Object(x["a"])(r,e);var t=Object(C["a"])(r);function r(){return Object(k["a"])(this,r),t.apply(this,arguments)}return Object(w["a"])(r,[{key:"consoleCluster",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.get("/console/cluster",t));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"consoleClusterPatch",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.put("/console/cluster/put",t));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delConsoleClusterName",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.delete("/console/cluster/".concat(t.name),{}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"consoleClusterPost",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.post("/console/cluster/post",t));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(V["Service"]),S=function(e){Object(x["a"])(r,e);var t=Object(C["a"])(r);function r(e){var n;return Object(k["a"])(this,r),n=t.call(this,e),n.service=new _,n.tableData=new D,n}return Object(w["a"])(r,[{key:"consoleCluster",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.service.consoleCluster(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"consoleClusterSuccess",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.tableData=t;case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"consoleClusterPatch",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.service.consoleClusterPatch(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delConsoleClusterName",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.service.delConsoleClusterName(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"consoleClusterPost",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.service.consoleClusterPost(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(V["VuexModule"]);Object(N["a"])([Object(V["Action"])({commit:"consoleClusterSuccess"})],S.prototype,"consoleCluster",null),Object(N["a"])([V["Mutation"]],S.prototype,"consoleClusterSuccess",null),Object(N["a"])([V["Action"]],S.prototype,"consoleClusterPatch",null),Object(N["a"])([V["Action"]],S.prototype,"delConsoleClusterName",null),Object(N["a"])([V["Action"]],S.prototype,"consoleClusterPost",null),S=Object(N["a"])([Object(V["Module"])({store:y["a"]})],S);var P=r("e9d5"),U=r("f64c"),T=r("d4fc"),A=function(e){Object(x["a"])(r,e);var t=Object(C["a"])(r);function r(){var e;return Object(k["a"])(this,r),e=t.call(this,arguments),e.tableRules={region:[{required:!0,message:"请填写 地区 .",trigger:"blur"}]},e.visible=!1,e.loading=!1,e.formData={},e.rules={name:[{required:!0,message:"请填写 名称 .",trigger:"blur"}],region:[{required:!0,message:"请填写 地区 .",trigger:"blur"}],description:[{required:!0,message:"请填写 备注 .",trigger:"blur"}],kubeconfig:[{required:!0,message:"请填写 Kubernetes 配置 .",trigger:"blur"}],volumes:[{required:!0,message:"请填写 磁盘信息 .",trigger:"blur"},{trigger:"blur",validator:function(e,t){try{JSON.parse(t);return Promise.resolve()}catch(r){return Promise.reject("请检查 磁盘信息 格式: ".concat(r.message))}}}]},e.configVisible=!1,e.configLoading=!1,e.config="",e.volumesVisible=!1,e.volumesLoading=!1,e.volumes="",e}return Object(w["a"])(r,[{key:"handleOk",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.form.validate().then(Object(j["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.consoleClusterPost(Object(g["a"])(Object(g["a"])({},t.formData),{},{kubeconfig:decodeURIComponent(t.formData.kubeconfig),volumes:JSON.parse(t.formData.volumes)}));case 3:if(r=e.sent,!r.err&&!r.errmsg){e.next=9;break}return e.next=7,U["a"].error(r.errmsg||"添加失败 .");case 7:e.next=11;break;case 9:return e.next=11,U["a"].success("添加成功 .");case 11:return t.loading=!1,t.visible=!1,e.next=15,t.reloadData();case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})))).catch((function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"editSubmit",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){var r,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=Object(T["a"])(this.xTable),n=r.validate,e.abrupt("return",n().then(Object(j["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=Object(g["a"])({},t),delete r._XID,e.next=4,a.consoleClusterPatch(r);case 4:if(n=e.sent,!n.err&&!n.errmsg){e.next=8;break}return e.next=8,U["a"].error(n.errmsg||"修改失败 .");case 8:return e.next=10,a.reloadData();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(111,e)})));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteRow",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.delConsoleClusterName(t);case 2:if(r=e.sent,!r.err&&!r.errmsg){e.next=8;break}return e.next=6,U["a"].error(r.errmsg||"删除失败 .");case 6:e.next=10;break;case 8:return e.next=10,U["a"].success("删除成功 .");case 10:return e.next=12,this.reloadData();case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"reloadData",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.consoleCluster({});case 2:return e.next=4,this.xTable.reloadData(this.tableData.clusterList);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"configShow",value:function(e){this.configVisible=!0,this.config=decodeURIComponent(e.kubeconfig),this.currentRow=Object(g["a"])({},e),delete this.currentRow._XID}},{key:"configHandleOk",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.configLoading=!0,e.next=3,this.consoleClusterPatch(Object(g["a"])(Object(g["a"])({},this.currentRow),{},{kubeconfig:encodeURIComponent(this.config)}));case 3:if(t=e.sent,!t.err&&!t.errmsg){e.next=9;break}return e.next=7,U["a"].error(t.errmsg||"修改失败 .");case 7:e.next=11;break;case 9:return e.next=11,U["a"].success("修改成功 .");case 11:return this.configLoading=!1,this.configVisible=!1,e.next=15,this.reloadData();case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"volumesShow",value:function(e){this.volumesVisible=!0,this.volumes=JSON.stringify(e.volumes,null,4),this.currentRow=Object(g["a"])({},e),delete this.currentRow._XID}},{key:"volumesHandleOk",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.volumesLoading=!0,t={},e.prev=2,t=JSON.parse(this.volumes),e.next=11;break;case 6:return e.prev=6,e.t0=e["catch"](2),e.next=10,U["a"].error("磁盘信息 必须是 JSON 格式 请检查格式 .");case 10:return e.abrupt("return",e.sent);case 11:return e.next=13,this.consoleClusterPatch(Object(g["a"])(Object(g["a"])({},this.currentRow),{},{volumes:t}));case 13:if(r=e.sent,!r.err&&!r.errmsg){e.next=19;break}return e.next=17,U["a"].error(r.errmsg||"修改失败 .");case 17:e.next=21;break;case 19:return e.next=21,U["a"].success("修改成功 .");case 21:return this.volumesLoading=!1,this.volumesVisible=!1,e.next=25,this.reloadData();case 25:case"end":return e.stop()}}),e,this,[[2,6]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.reloadData();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"tableData",get:function(){return Object(V["useState"])(S).tableData}},{key:"consoleCluster",get:function(){return Object(V["useAction"])(S).consoleCluster}},{key:"consoleClusterPatch",get:function(){return Object(V["useAction"])(S).consoleClusterPatch}},{key:"delConsoleClusterName",get:function(){return Object(V["useAction"])(S).delConsoleClusterName}},{key:"consoleClusterPost",get:function(){return Object(V["useAction"])(S).consoleClusterPost}}]),r}(V["Vue"]);A=Object(N["a"])([Object(V["Component"])({components:{SearchOutlined:P["a"]}})],A);var I=A;r("c18e");I.render=O,I.__scopeId="data-v-e24958ee";t["default"]=I},c18e:function(e,t,r){"use strict";r("20b1")},d4fc:function(e,t,r){"use strict";var n=r("a449");r.d(t,"a",(function(){return n["b"]}))},eab1:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("d4ec"),a=function e(){Object(n["a"])(this,e)}}}]);